## Finance | Robust deep hedging

Authors: Eva LÃ¼tkebohmert, Thorsten Schmidt, Julian Sester

Link: [https://arxiv.org/abs/2106.10024](https://link.zhihu.com/?target=https%3A//arxiv.org/abs/2106.10024)

#### Abstract

> We study pricing and hedging under parameter uncertainty for a class of Markov processes which we call generalized affine processes and which includes the Black Scholes model as well as the constant elasticity of variance (CEV) model as special cases. Based on a general dynamic programming principle, we are able to link the associated nonlinear expectation to a variationally form of the Kolmogorov equation which opens the door for fast numerical pricing in the robust framework. The main novelty of the paper is that we propose a deep hedging approach which efficiently solves the hedging problem under parameter uncertainty. We numerically evaluate this method on simulated and real data and show that the robust deep hedging outperforms existing hedging approaches, in particular in highly volatile periods.

#### Introduction

In the beginning, the authors raised the classical estimation problem in predicting the evolution of a stock in the future, which is that parameters estimated carry confidence intervals which need to be taken into account for the prediction. In particular, changes in the underlying dynamics are "rather the rule than the exception and additional uncertainty and model risk come into play, widening the confidence interval". 

#### Methodology

The deep learning approach for hedging under parameter uncertainty is based on recent developed class of affine processes under parameter uncertainty, which is simply referred as "nonlinear affine processes (NGA)". 

In terms of a realistic data application, authors have chosen the COVID-19 period since stock markets experienced unexpectedly high volatility and variation in the price paths. In order to find reliable estimated for the parameter intervals specifying the uncertainty in the considered model class, a sliding-window MLE (maximum-likelihood estimation) approach was used. 

**Parameterization**

A generalized affine diffusion is a continuous semimartingale X ([definition] Semimartingale: In probability theory, a real valued stochastic process X is called a semimartingale if it can be decomposed as the sum of a local martingale and an adapted finite-variation process. ) which is a unique strong solution of the stochastic differential equation (SDE):

![](https://www.zhihu.com/equation?tex=dX_t%3D%28b_0%2Bb_1X_t%29dt+%2B%28a_0%2Ba_1X_t%29%5E%5Cgamma+dW_t) , where ![](https://www.zhihu.com/equation?tex=%5Cgamma%3D1%2F2) gives the well-known special case of a (continuous) affine process.

Another intuition here within parameter uncertainty is that: instead of assuming the parameter ![](https://www.zhihu.com/equation?tex=%5Ctheta) to be known exactly, the authors introduce an interval ![](https://www.zhihu.com/equation?tex=%5B%5Cunderline%7B%5Ctheta%7D%2C+%5Cbar%7B%5Ctheta%7D%5D) and consider each value in the interval equally possible. The description of the generalized affine process under parameter uncertainty is now intuitively given by all those probability laws describing a diffusion where the drift and the volatility always stay in the intervals ![](https://www.zhihu.com/equation?tex=b%28x%29) and ![](https://www.zhihu.com/equation?tex=a%28x%29) . 

**Robust pricing of derivatives**

The study has considered an European claim with maturity ![](https://www.zhihu.com/equation?tex=T) and payoff ![](https://www.zhihu.com/equation?tex=%5Cpsi%28X_T%29) . The value function v is defined as:

![](https://www.zhihu.com/equation?tex=v%28t%2Cx%29%3A%3D%5Csup_%7BP%5Cin+A%28t%2C+x%2C%5CTheta%29%7D%5Cmathbb%7BE%7D%5EP%5B%5Cpsi%28X_T%29%5D)

where A is referred as all absolutely continuous semimartingale laws. 

In the next stage of the study, the authors used nonlinear Kolmogorov equation as an efficient tool to compute the value function by solving nonlinear partial differential equations numerically (based on Theorem 2.2, page 5). In other words, the goal here is to find a numerical procedure which replaces the classical Monte-Carlo estimation in a robust setting. 

In particular, deep neutral networks were applied to find the optimal parameters within the given intervals (i.e. parameter uncertainty) in order to minimize the hedging error. The full procedure is summarized by the algorithm 1 below:

![](https://pic3.zhimg.com/80/v2-ddf41a684796a41ae21312cbe4dd79d6_1440w.jpg)

If you are interested in further application of this robust hedging strategy in option products or real life data, more examples can be found in the paper:

- 3.2.1 Hedging of at-the-money call options, page7-9
- 3.2.2. Hedging of a butterfly option, page9-10
- 3.2.3 Hedging of a path-dependent option, page10
- 4 US stock market index S&P 500 from 26 September 2008 until 09 April 2020 from Thomson Reuters Eikon (excluding the Covid-19 period for containing high volatility)
